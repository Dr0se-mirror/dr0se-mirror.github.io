{"title":"HNCTF 2022 week1 Writeup","uid":"93ccd316627eee66752597ff33d20c8e","slug":"HNCTF2022Week1部分wp","date":"2023-05-04T17:13:22.000Z","updated":"2023-05-04T17:18:12.637Z","comments":true,"path":"api/articles/HNCTF2022Week1部分wp.json","keywords":null,"cover":[],"content":"<h1 id=\"HNCTF-2022-Week1-easy-html\"><a href=\"#HNCTF-2022-Week1-easy-html\" class=\"headerlink\" title=\"[HNCTF 2022 Week1]easy_html\"></a>[HNCTF 2022 Week1]easy_html</h1><img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504185253310.png\" class=\"\" title=\"image-20230504185253310\">\n\n<p>看看cookie</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504185318146-1683197599567-1.png\" class=\"\" title=\"image-20230504185318146\">\n\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504185355196.png\" class=\"\" title=\"image-20230504185355196\">\n\n<p>有个框框，来我们猜猜是什么?xss ,ssti,sql?</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504185502586.png\" class=\"\" title=\"image-20230504185502586\">\n\n<p>但是我发现这里好像只有10个位置，我的思路第一时间想到1到9999999999爆破。经过我的不断尝试，发现，我是呆逼</p>\n<p>手机号怎么可能只有10位呢。</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504230933887.png\" class=\"\" title=\"image-20230504230933887\">\n\n<p>随便修改前端为超过10的数，然后输入10个以上的数就ok了</p>\n<p>亏得我电脑风扇还飞了起来</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504231059370.png\" class=\"\" title=\"image-20230504231059370\">\n\n<h1 id=\"HNCTF-2022-Week1-Interesting-include\"><a href=\"#HNCTF-2022-Week1-Interesting-include\" class=\"headerlink\" title=\"[HNCTF 2022 Week1]Interesting_include\"></a>[HNCTF 2022 Week1]Interesting_include</h1><img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504231310128.png\" class=\"\" title=\"image-20230504231310128\">\n\n<p>读题就是过滤了大小写flag</p>\n<p>这种直接用过滤器，因为正则匹配都是匹配字符，而过滤器传递的是路径当攻击者使用<code>php://filter/read=convert.base64-encode/resource=flag.php</code>作为<code>filter</code>参数时，PHP解析器会将这个参数作为一个文件路径，传递给<code>include</code>函数。因为这个参数不是一个标准的文件路径，而是一个流过滤器，因此在执行<code>include</code>函数时，会先对这个参数进行处理，将<code>flag.php</code>文件的内容转换为base64编码，再输出到标准输出流中。</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504232732700.png\" class=\"\" title=\"image-20230504232732700\">\n\n<h1 id=\"HNCTF-2022-Week1-easy-upload\"><a href=\"#HNCTF-2022-Week1-easy-upload\" class=\"headerlink\" title=\"[HNCTF 2022 Week1]easy_upload\"></a>[HNCTF 2022 Week1]easy_upload</h1><p>基础中的基础，直接改后缀名为php，蚁剑连接根目录一看就有了</p>\n<h1 id=\"HNCTF-2022-Week1-Interesting-http\"><a href=\"#HNCTF-2022-Week1-Interesting-http\" class=\"headerlink\" title=\"[HNCTF 2022 Week1]Interesting_http\"></a>[HNCTF 2022 Week1]Interesting_http</h1><p>一开始叫我们post一个want</p>\n<p>按他说的做</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504234323420.png\" class=\"\" title=\"image-20230504234323420\">\n\n<p>然后想要啥flag</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504234344246.png\" class=\"\" title=\"image-20230504234344246\">\n\n<p>肯定没那么简单</p>\n<p>这种不是管理员一般看看cookie</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504234418961.png\" class=\"\" title=\"image-20230504234418961\">\n\n<p>改改</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504234714102.png\" class=\"\" title=\"image-20230504234714102\">\n\n<p>xff改改</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504235028338.png\" class=\"\" title=\"image-20230504235028338\">\n\n<h1 id=\"HNCTF-2022-Week1-Challenge-rce\"><a href=\"#HNCTF-2022-Week1-Challenge-rce\" class=\"headerlink\" title=\"[HNCTF 2022 Week1]Challenge__rce\"></a>[HNCTF 2022 Week1]Challenge__rce</h1><img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504235154532.png\" class=\"\" title=\"image-20230504235154532\">\n\n<p>传个hint试试</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504235229690.png\" class=\"\" title=\"image-20230504235229690\">\n\n<p>一眼顶真</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230504235702237.png\" class=\"\" title=\"image-20230504235702237\">\n\n<p>无字符rce</p>\n<p>一直有接触但是没有系统学习，这里来一波。</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230505000450320.png\" class=\"\" title=\"image-20230505000450320\">\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">参考：https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;8107</code></pre>\n\n<p>最简单的无字符过滤</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\nif(!preg_match(&#39;&#x2F;[a-z0-9]&#x2F;is&#39;,$_GET[&#39;shell&#39;])) &#123;\n  eval($_GET[&#39;shell&#39;]);\n&#125;</code></pre>\n\n<p>研究这段代码的绕过</p>\n<p>我们先从异或看起</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230505004935789.png\" class=\"\" title=\"image-20230505004935789\">\n\n<p>输出是’o’，我们来分析下原因,5的ASCII码是53,转成二进制是00110101,Z的ASCII码是90,转成二进制是01011010,将他们进行异或,为,也即十进制的111,为o</p>\n<img src=\"/2023/05/05/HNCTF2022Week1%E9%83%A8%E5%88%86wp/image-20230505005231627.png\" class=\"\" title=\"image-20230505005231627\">\n\n<p>再学习一下这段代码</p>\n<p>刚刚讲过’5’^’Z’为’o’</p>\n<p>这样我们就将$__赋值为’o’然后php允许把字符串当函数用。这样我们就成功的调用了o()这个函数</p>\n<p>$_是一个没有定义过的变量，php会给他赋一个默认值NULL&#x3D;&#x3D;0</p>\n<p>那么这个1就不难理解了</p>\n","text":"[HNCTF 2022 Week1]easy_html 看看cookie 有个框框，来我们猜猜是什么?xss ,ssti,sql? 但是我发现这里好像只有10个位置，我的思路第一时间想到1到9999999999爆破。经过我的不断尝试，发现，我是呆逼 手机号怎么可能只有10位呢。 ...","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"writeups","slug":"writeups","count":1,"path":"api/categories/writeups.json"}],"tags":[{"name":"html","slug":"html","count":1,"path":"api/tags/html.json"},{"name":"无字符rce","slug":"无字符rce","count":1,"path":"api/tags/无字符rce.json"},{"name":"文件上传","slug":"文件上传","count":1,"path":"api/tags/文件上传.json"},{"name":"文件包含","slug":"文件包含","count":1,"path":"api/tags/文件包含.json"},{"name":"cookie","slug":"cookie","count":1,"path":"api/tags/cookie.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#HNCTF-2022-Week1-easy-html\"><span class=\"toc-text\">[HNCTF 2022 Week1]easy_html</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#HNCTF-2022-Week1-Interesting-include\"><span class=\"toc-text\">[HNCTF 2022 Week1]Interesting_include</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#HNCTF-2022-Week1-easy-upload\"><span class=\"toc-text\">[HNCTF 2022 Week1]easy_upload</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#HNCTF-2022-Week1-Interesting-http\"><span class=\"toc-text\">[HNCTF 2022 Week1]Interesting_http</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#HNCTF-2022-Week1-Challenge-rce\"><span class=\"toc-text\">[HNCTF 2022 Week1]Challenge__rce</span></a></li></ol>","author":{"name":"Dr0se","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"代码审计漫谈","uid":"190a5681495c8fcf46bf22c2590b534f","slug":"代码审计漫谈","date":"2023-05-05T10:30:49.000Z","updated":"2023-05-05T13:19:17.203Z","comments":true,"path":"api/articles/代码审计漫谈.json","keywords":null,"cover":[],"text":"前言因为自己想做一个代码审计工具，自己之前是有做过一点点代码审计的。审计过熊海，bluecms等等简单的一些cms。但是对其中的很多深层次原理都不了解。甚至可以说一点点都不懂，毕竟从用一个工具到做一个工具就是有本质上的区别。 于我而言，做一个工具肯定是有很大的提升的。对于这个工具...","link":"","photos":[],"count_time":{"symbolsCount":"5.9k","symbolsTime":"5 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":1,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":1,"path":"api/tags/代码审计.json"}],"author":{"name":"Dr0se","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{}}