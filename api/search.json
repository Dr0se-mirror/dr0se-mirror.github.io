[{"id":"93ccd316627eee66752597ff33d20c8e","title":"HNCTF 2022 week1 Writeup","content":"[HNCTF 2022 Week1]easy_html\n\n看看cookie\n\n\n\n\n有个框框，来我们猜猜是什么?xss ,ssti,sql?\n\n\n但是我发现这里好像只有10个位置，我的思路第一时间想到1到9999999999爆破。经过我的不断尝试，发现，我是呆逼\n手机号怎么可能只有10位呢。\n\n\n随便修改前端为超过10的数，然后输入10个以上的数就ok了\n亏得我电脑风扇还飞了起来\n\n\n[HNCTF 2022 Week1]Interesting_include\n\n读题就是过滤了大小写flag\n这种直接用过滤器，因为正则匹配都是匹配字符，而过滤器传递的是路径当攻击者使用php://filter/read=convert.base64-encode/resource=flag.php作为filter参数时，PHP解析器会将这个参数作为一个文件路径，传递给include函数。因为这个参数不是一个标准的文件路径，而是一个流过滤器，因此在执行include函数时，会先对这个参数进行处理，将flag.php文件的内容转换为base64编码，再输出到标准输出流中。\n\n\n[HNCTF 2022 Week1]easy_upload基础中的基础，直接改后缀名为php，蚁剑连接根目录一看就有了\n[HNCTF 2022 Week1]Interesting_http一开始叫我们post一个want\n按他说的做\n\n\n然后想要啥flag\n\n\n肯定没那么简单\n这种不是管理员一般看看cookie\n\n\n改改\n\n\nxff改改\n\n\n[HNCTF 2022 Week1]Challenge__rce\n\n传个hint试试\n\n\n一眼顶真\n\n\n无字符rce\n一直有接触但是没有系统学习，这里来一波。\n\n\n参考：https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;8107\n\n最简单的无字符过滤\n&lt;?php\nif(!preg_match(&#39;&#x2F;[a-z0-9]&#x2F;is&#39;,$_GET[&#39;shell&#39;])) &#123;\n  eval($_GET[&#39;shell&#39;]);\n&#125;\n\n研究这段代码的绕过\n我们先从异或看起\n\n\n输出是’o’，我们来分析下原因,5的ASCII码是53,转成二进制是00110101,Z的ASCII码是90,转成二进制是01011010,将他们进行异或,为,也即十进制的111,为o\n\n\n再学习一下这段代码\n刚刚讲过’5’^’Z’为’o’\n这样我们就将$__赋值为’o’然后php允许把字符串当函数用。这样我们就成功的调用了o()这个函数\n$_是一个没有定义过的变量，php会给他赋一个默认值NULL&#x3D;&#x3D;0\n那么这个1就不难理解了\n","slug":"HNCTF2022Week1部分wp","date":"2023-05-04T17:13:22.000Z","categories_index":"writeups","tags_index":"html,无字符rce,文件上传,文件包含,cookie","author_index":"Dr0se"}]